filter(T1Dgroup != "") %>%               # remove rows with blank T1Dgroup
group_by(ID) %>%
slice_max(DOVISIT, with_ties = FALSE) %>% # keep latest visit per ID
ungroup()
# Check number of unique IDs
length(unique(pheno_daisy$ID))
# Preview
head(pheno_daisy)
# creating ID column in grs2x_daisy from IID column
grs2x_daisy$ID <- sub("_.*", "", grs2x_daisy$IID)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom" | pheno_daisy$DMfamily == "mom/dad", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D group
table1(~ fdr_4level + SEX | T1Dgroup, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
View(pheno_teddy)
head(pheno_teddy)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D group
table1(~ fdr_4level + SEX | T1Dgroup, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D group
table1(~ fdr_4level + SEX | T1Dgroup, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
# Prep data for whole section
pheno_daisy <- pheno_daisy %>%
dplyr::mutate(T1D = factor(T1Dgroup,
levels = c("T1D case", "T1D control"),
labels = c("Case", "Control")))
# Recode family_mem_screen into 4-level factor: none, mom, dad, sibling
pheno_teddy <- pheno_teddy %>%
mutate(fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all other multi-codes (1,2,3,4) set to none
))
# Make it a factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Recode family_mem_screen into 4-level factor: none, mom, dad, sibling
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # keep ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
Sex  = SEX,
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all other multi-codes (1,2,3,4) set to none
)
)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Prep data for whole section
pheno_daisy <- pheno_daisy %>%
dplyr::mutate(T1D = factor(T1Dgroup,
levels = c("T1D case", "T1D control"),
labels = c("Case", "Control")),
Sex = SEX)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D group
table1(~ fdr_4level + Sex | T1Dgroup, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Prep data for whole section
pheno_daisy <- pheno_daisy %>%
dplyr::mutate(T1D = factor(T1Dgroup,
levels = c("T1D case", "T1D control"),
labels = c("Case", "Control")),
Sex = SEX)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D
table1(~ fdr_4level + Sex | T1D, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Prep data for whole section
pheno_daisy <- pheno_daisy %>%
dplyr::mutate(T1D = factor(T1Dgroup,
levels = c("T1D case", "T1D control"),
labels = c("Case", "Control")),
Sex = SEX)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D
table1(~ fdr_4level + Sex | T1D, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
# Recode family_mem_screen into 4-level factor: none, mom, dad, sibling
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # keep ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
Sex  = SEX,
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all other multi-codes (1,2,3,4) set to none
)
)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(
root.dir = paste0(Sys.getenv("RKJCOLLAB"))) #setting up pathway
library(tidyverse)
library(table1)
library(ggpubr)
library(haven)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(
root.dir = paste0(Sys.getenv("RKJCOLLAB"))) #setting up pathway
library(tidyverse)
library(table1)
library(ggpubr)
library(haven)
# Read in research GRS2 results
grs2x_daisy <- read_csv(
"DAISY/genetics/daisy_ask_genetics/risk_scores/data/grs2x/tm_r3_imp/score_results.csv")
grs2x_teddy <- read_tsv(
"Immunogenetics_T1D/genetics/teddy_r01/risk_scores/grs2x/score_results_imputed.csv")
# Read in pheno files
pheno_daisy <-read_sas("DAISY/pheno/ivyomicssample.sas7bdat")
pheno_teddy<- read_sas("Immunogenetics_T1D/raw/teddy_r01/2025-09-17/rj_immuno_all_demo_masked_v2.sas7bdat")
# cleaning phenotype file in DAISY
pheno_daisy <- pheno_daisy %>%
filter(T1Dgroup != "") %>%               # remove rows with blank T1Dgroup
group_by(ID) %>%
slice_max(DOVISIT, with_ties = FALSE) %>% # keep latest visit per ID
ungroup()
# Check number of unique IDs
length(unique(pheno_daisy$ID))
# Preview
head(pheno_daisy)
# creating ID column in grs2x_daisy from IID column
grs2x_daisy$ID <- sub("_.*", "", grs2x_daisy$IID)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Prep data for whole section
pheno_daisy <- pheno_daisy %>%
dplyr::mutate(T1D = factor(T1Dgroup,
levels = c("T1D case", "T1D control"),
labels = c("Case", "Control")),
Sex = SEX)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D
table1(~ fdr_4level + Sex | T1D, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
head(pheno_teddy)
# Recode family_mem_screen into 4-level factor: none, mom, dad, sibling
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # keep ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
Sex  = SEX,
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all other multi-codes (1,2,3,4) set to none
)
)
# Recode family_mem_screen into 4-level factor: none, mom, dad, sibling
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # keep ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all other multi-codes (1,2,3,4) set to none
)
)
# Make it a factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Create descriptive table by T1D group
table1(~ fdr_4level + SEX | t1d, data = pheno_teddy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_teddy$ID, grs2x_daisy$ID)
# Recode family_mem_screen into 4-level factor: none, mom, dad, sibling
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # keep ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all other multi-codes (1,2,3,4) set to none
)
)
# Make it a factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Create descriptive table by T1D group
table1(~ fdr_4level + Sex | t1d, data = pheno_teddy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_teddy$ID, grs2x_teddy$ID)
# Recode family_mem_screen into 4-level factor: none, mom, dad, sibling
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # keep ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all other multi-codes (1,2,3,4) set to none
)
)
# Make it a factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Create descriptive table by T1D group
table1(~ fdr_4level + Sex | t1d, data = pheno_teddy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_teddy$ID, grs2x_teddy$ID)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(
root.dir = paste0(Sys.getenv("RKJCOLLAB"))) #setting up pathway
library(tidyverse)
library(table1)
library(ggpubr)
library(haven)
# Read in research GRS2 results
grs2x_daisy <- read_csv(
"DAISY/genetics/daisy_ask_genetics/risk_scores/data/grs2x/tm_r3_imp/score_results.csv")
grs2x_teddy <- read_tsv(
"Immunogenetics_T1D/genetics/teddy_r01/risk_scores/grs2x/score_results_imputed.csv")
# Read in pheno files
pheno_daisy <-read_sas("DAISY/pheno/ivyomicssample.sas7bdat")
pheno_teddy<- read_sas("Immunogenetics_T1D/raw/teddy_r01/2025-09-17/rj_immuno_all_demo_masked_v2.sas7bdat")
# cleaning phenotype file in DAISY
pheno_daisy <- pheno_daisy %>%
filter(T1Dgroup != "") %>%               # remove rows with blank T1Dgroup
group_by(ID) %>%
slice_max(DOVISIT, with_ties = FALSE) %>% # keep latest visit per ID
ungroup()
# Check number of unique IDs
length(unique(pheno_daisy$ID))
# Preview
head(pheno_daisy)
# creating ID column in grs2x_daisy from IID column
grs2x_daisy$ID <- sub("_.*", "", grs2x_daisy$IID)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Prep data for whole section
pheno_daisy <- pheno_daisy %>%
dplyr::mutate(T1D = factor(T1Dgroup,
levels = c("T1D case", "T1D control"),
labels = c("Case", "Control")),
Sex = SEX)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D
table1(~ fdr_4level + Sex | T1D, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
head(pheno_teddy)
names(pheno_teddy)
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # rename MaskID → ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all multi-codes (1,2,3,4) → none
)
)
# Make fdr_4level an ordered factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Create descriptive table by T1D group
table1(~ fdr_4level + Sex | T1D, data = pheno_teddy, overall = "Total")
# Compare IDs across datasets
d_miss <- setdiff(pheno_teddy$ID, grs2x_teddy$ID)
names(grs2x_teddy)
View(grs2x_teddy)
names(grs2x_teddy)
names(grs2x_teddy)
names(grs2x_teddy)
names(grs2x_teddy)
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # rename MaskID → ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all multi-codes (1,2,3,4) → none
)
)
# Make fdr_4level an ordered factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Create descriptive table by T1D group
table1(~ fdr_4level + Sex | T1D, data = pheno_teddy, overall = "Total")
# Compare IDs across datasets
d_miss <- setdiff(pheno_teddy$ID, grs2x_teddy$ID)
names(grs2x_teddy)
# Read in research GRS2 results
grs2x_daisy <- read_csv(
"DAISY/genetics/daisy_ask_genetics/risk_scores/data/grs2x/tm_r3_imp/score_results.csv")
grs2x_teddy <- read_csv(
"Immunogenetics_T1D/genetics/teddy_r01/risk_scores/grs2x/score_results_imputed.csv")
# Read in pheno files
pheno_daisy <-read_sas("DAISY/pheno/ivyomicssample.sas7bdat")
pheno_teddy<- read_sas("Immunogenetics_T1D/raw/teddy_r01/2025-09-17/rj_immuno_all_demo_masked_v2.sas7bdat")
View(pheno_teddy)
View(grs2x_teddy)
# Read in research GRS2 results
grs2x_daisy <- read_csv(
"DAISY/genetics/daisy_ask_genetics/risk_scores/data/grs2x/tm_r3_imp/score_results.csv")
grs2x_teddy <- read_csv(
"Immunogenetics_T1D/genetics/teddy_r01/risk_scores/grs2x/score_results_imputed.csv")
# Read in pheno files
pheno_daisy <-read_sas("DAISY/pheno/ivyomicssample.sas7bdat")
pheno_teddy<- read_sas("Immunogenetics_T1D/raw/teddy_r01/2025-09-17/rj_immuno_all_demo_masked_v2.sas7bdat")
# cleaning phenotype file in DAISY
pheno_daisy <- pheno_daisy %>%
filter(T1Dgroup != "") %>%               # remove rows with blank T1Dgroup
group_by(ID) %>%
slice_max(DOVISIT, with_ties = FALSE) %>% # keep latest visit per ID
ungroup()
# Check number of unique IDs
length(unique(pheno_daisy$ID))
# Preview
head(pheno_daisy)
# creating ID column in grs2x_daisy from IID column
grs2x_daisy$ID <- sub("_.*", "", grs2x_daisy$IID)
# Recode DMfamily into 4-level factor: none, mom, dad, sibling
pheno_daisy$fdr_4level <- factor(
ifelse(pheno_daisy$DMfamily == "" | is.na(pheno_daisy$DMfamily), "none",
ifelse(pheno_daisy$DMfamily == "mom", "mom",
ifelse(pheno_daisy$DMfamily == "dad", "dad",
"sibling"))),
ordered = FALSE
)
# Prep data for whole section
pheno_daisy <- pheno_daisy %>%
dplyr::mutate(T1D = factor(T1Dgroup,
levels = c("T1D case", "T1D control"),
labels = c("Case", "Control")),
Sex = SEX)
# Set reference level to "none"
pheno_daisy$fdr_4level <- relevel(pheno_daisy$fdr_4level, ref = "none")
# table(pheno_daisy$fdr_4level)
# table(pheno_daisy$DMfamily, pheno_daisy$fdr_4level)
# Create descriptive table by T1D
table1(~ fdr_4level + Sex | T1D, data = pheno_daisy, overall = "Total")
# Find missing IDs in another dataset
d_miss <- setdiff(pheno_daisy$ID, grs2x_daisy$ID)
head(pheno_teddy)
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # rename MaskID → ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all multi-codes (1,2,3,4) → none
)
)
# Make fdr_4level an ordered factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Create descriptive table by T1D group
table1(~ fdr_4level + Sex | T1D, data = pheno_teddy, overall = "Total")
# Compare IDs across datasets
d_miss <- setdiff(pheno_teddy$ID, grs2x_teddy$ID)
# Compare IDs across datasets
d_miss <- setdiff(pheno_teddy$ID, grs2x_teddy$ID)
pheno_teddy <- pheno_teddy %>%
dplyr::mutate(
ID   = RJohnson_Immuno_anc_MaskID,   # rename MaskID → ID
T1D  = factor(t1d,
levels = c(1, 0),
labels = c("Case", "Control")),
fdr_4level = case_when(
family_mem_screen == 0 ~ "none",
family_mem_screen == 5 ~ "mom",      # only mom
family_mem_screen == 6 ~ "dad",      # only dad
family_mem_screen == 7 ~ "sibling",  # only sibling
TRUE ~ "none"  # all multi-codes (1,2,3,4) → none
)
)
# Make fdr_4level an ordered factor with "none" as reference
pheno_teddy$fdr_4level <- factor(pheno_teddy$fdr_4level,
levels = c("none", "mom", "dad", "sibling"))
# Create descriptive table by T1D group
table1(~ fdr_4level + Sex | T1D, data = pheno_teddy, overall = "Total")
View(pheno_teddy)
View(pheno_daisy)
View(pheno_teddy)
